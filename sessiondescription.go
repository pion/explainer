// SPDX-FileCopyrightText: 2023 The Pion community <https://pion.ly>
// SPDX-License-Identifier: MIT

package explainer

// sessionDescription is generated by a WebRTC Agent. This is used to transport
// Offers and Answers.
type sessionDescription struct {
	Type string `json:"type"`
	SDP  string `json:"sdp"`
}

func (s *sessionDescription) unmarshal(in string) { //nolint:cyclop
	inTag := false
	inString := false

	tagValue := ""

	for i := 0; i < len(in); i++ {
		switch {
		case in[i] == '"':
			switch {
			case inString:
				inString = false
				tagValue = ""
			case inTag:
				inTag = false
			case tagValue != "":
				inString = true
			default:
				inTag = true
			}
		case inTag:
			tagValue += string(in[i])
		case inString:
			switch tagValue {
			case "type":
				s.Type += string(in[i])
			case "sdp":
				s.SDP += string(in[i])
			}
		}
	}
}
